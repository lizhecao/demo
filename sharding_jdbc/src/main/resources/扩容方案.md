# 双写

1. 老服务双写。（新的数据服务只对新库读写）

- 读始终读老的
- 写的话要同时写新库

2. 迁移服务上线
- 从老库中度数据，属于新库的就写到新库
- 一直写到出现重复建异常。说明已经到了双写开始后新建的key了

3. 新服务上线
- 读写都包含新老库

4. 删除老库中的数据
- 按分布式key 排序获取数据，一直删到新服务上线后的最新分布式key id